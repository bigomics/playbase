% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pgx-tcga.R
\name{pgx.testTCGAsurvival}
\alias{pgx.testTCGAsurvival}
\title{Test survival association with TCGA expression data}
\usage{
pgx.testTCGAsurvival(
  sig,
  matrix_file,
  ntop = 100,
  deceased.only = TRUE,
  min.cases = 10,
  sortby.p = FALSE,
  plot = TRUE,
  verbose = 1
)
}
\arguments{
\item{sig}{A named numeric vector of signature scores for each gene.}

\item{matrix_file}{Path to TCGA expression matrix HDF5 file.}

\item{ntop}{Number of top differentially expressed genes to test. Default 100.}

\item{deceased.only}{Only use samples from deceased patients if TRUE. Default TRUE.}

\item{min.cases}{Minimum number of cases (deaths) required. Default 10.}

\item{sortby.p}{Sort results by p-value instead of hazard ratio if TRUE. Default FALSE.}

\item{plot}{Logical to generate a survival plot if TRUE. Default TRUE.}

\item{verbose}{Print progress messages if TRUE. Default 1.}
}
\value{
A data frame with gene symbol, hazard ratio, p-value, and number of cases for the ntop signature genes tested.
}
\description{
Test the association between a gene signature and survival using TCGA expression data.
}
\details{
This function tests the association between a gene signature (sig) and survival using TCGA expression data.
It extracts the top differentially expressed genes from the signature, then reads their expression from a TCGA HDF5 matrix file. 
Survival data is obtained from the RTCGA_SURVIVAL dataset. The signature scores are tested for association with overall survival 
using a Cox proportional hazards model. Results include the hazard ratio, p-value, and number of cases for each gene. A survival 
plot can also be generated.
}

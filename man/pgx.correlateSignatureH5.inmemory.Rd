% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pgx-signature.R
\name{pgx.correlateSignatureH5.inmemory}
\alias{pgx.correlateSignatureH5.inmemory}
\alias{pgx.correlateSignatureH5}
\title{Correlate signature with datasets in HDF5 file}
\usage{
pgx.correlateSignatureH5.inmemory(
  F,
  h5.file,
  nsig = 100,
  ntop = 1000,
  nperm = 1000
)

pgx.correlateSignatureH5(
  fc,
  h5.file,
  nsig = 100,
  ntop = 1000,
  nperm = 10000,
  h5.data = "data/matrix",
  h5.rn = "data/rownames",
  h5.cn = "data/colnames"
)
}
\arguments{
\item{F}{Numeric vector of signature fold changes}

\item{h5.file}{Path to HDF5 file containing dataset expression matrices}

\item{nsig}{Number of signature genes to use for correlation. Default 100.}

\item{ntop}{Number of top correlated genes to use for GSEA. Default 1000.}

\item{nperm}{Number of permutations for GSEA. Default 1000.}

\item{h5.data:}{HDF5 location of dataset expression matrices}

\item{h5.rn:}{HDF5 location of dataset rownames}

\item{h5.cn:}{HDF5 location of dataset colnames}
}
\value{
Data frame with correlation results and GSEA enrichment scores.

Data frame with the correlation coefficient, p-value, and normalized enrichment score (NES) for each dataset.
}
\description{
Correlates a signature (fold change vector) with datasets in an HDF5 file using in-memory computations instead of on-disk.
It is also possible to run the operation on-disk via \code{pgx.correlateSignatureH5}.
}
\details{
This function computes the correlation and gene set enrichment between a
signature fold change vector \code{F} and dataset expression matrices stored in an
HDF5 file at \code{h5.file}.

It first reads the top \code{nsig} signature genes into memory.
Then it computes pairwise Pearson correlation between the signature and each dataset.
It also runs pre-ranked GSEA using the \code{fgsea} package to compute enrichment scores.

The main difference from \code{\link{pgx.correlateSignatureH5}} is that correlations
and GSEA are computed in memory instead of using on-disk chunks. This is faster for
small datasets but requires loading the full expression matrix into memory.
}
\section{Functions}{
\itemize{
\item \code{pgx.correlateSignatureH5()}: computes correlation and gene set enrichment between a
signature and datasets in an HDF5 file using on-disk chunked computations

}}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pgx-correct.R
\name{pgx.svaCorrect}
\alias{pgx.svaCorrect}
\title{Surrogate variable analysis batch correction}
\usage{
pgx.svaCorrect(X, pheno, nmax = -1)
}
\arguments{
\item{X}{Gene expression matrix, genes in rows and samples in columns.}

\item{pheno}{Dataframe containing sample metadata/covariates. Must match colnames of \code{X}.}

\item{batch}{Factor or matrix indicating batch groups for each sample.}

\item{model.par}{Vector of column names in \code{pheno} to use as model covariates.}

\item{n.sv}{Number of surrogate variables to estimate. If NULL uses a data-driven approach.}
}
\value{
Batch corrected gene expression matrix.
}
\description{
Performs batch correction using surrogate variable analysis (SVA).
Estimates surrogate variables and removes them from the expression data.
}
\details{
This function performs batch correction using the sva R package.

It constructs a design matrix containing the specified batch groups and covariates.
Surrogate variables are estimated to capture remaining batch effects.

The top surrogate variables are included in the design matrix and removed from the expression data.
This accounts for batch effects in a completely unsupervised way.
}
